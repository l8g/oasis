### 植物管理模块

**功能概述**

管理植物的创建、升级、技能触发和状态管理。具体包括处理植物的攻击、生成资源、协同作用等行为。

**类结构**

- **PlantManager**：管理所有植物实例
  - **属性**：
    - **plants**：List<Plant> - 存储所有植物实例的列表
  - **方法**：
    - **CreatePlant(type, position)**：Plant - 创建指定类型的植物并放置在特定位置
      - **使用场景**：当玩家在游戏中选择种植植物时，调用此方法创建植物实例。
    - **RemovePlant(plantId)**：void - 删除指定ID的植物
      - **使用场景**：当植物被摧毁或移除时，调用此方法删除植物实例。
    - **UpdatePlants()**：void - 更新所有植物的状态
      - **使用场景**：游戏运行过程中，定期调用此方法更新植物状态。
    - **UpgradePlant(plantId, level)**：void - 升级指定ID的植物到指定等级
      - **使用场景**：当玩家选择升级植物时，调用此方法更新植物属性。
    - **TriggerSkill(plantId)**：void - 触发指定植物的技能
      - **使用场景**：当植物需要触发特殊技能时，调用此方法执行技能效果。

- **Plant**：植物基类
  - **属性**：
    - **id**：int - 植物的唯一标识符
    - **type**：string - 植物类型
    - **health**：int - 植物的生命值
    - **attackPower**：int - 攻击力
    - **skill**：Skill - 特殊技能
    - **level**：int - 植物的等级
    - **state**：State - 植物的状态（如正常、冰冻、燃烧等）
  - **方法**：
    - **TakeDamage(amount)**：void - 使植物受到指定量的伤害
      - **使用场景**：当植物受到攻击时，调用此方法减少植物生命值。
    - **UseSkill()**：void - 触发植物的特殊技能
      - **使用场景**：当植物触发技能时，调用此方法执行技能效果。
    - **Upgrade(level)**：void - 升级植物到指定等级
      - **使用场景**：当植物升级时，调用此方法更新植物属性。
    - **ChangeState(state)**：void - 改变植物的状态
      - **使用场景**：当植物状态改变时，调用此方法更新状态。

- 具体植物类（如**Peashooter**, **Sunflower**）：继承自Plant类，实现每种植物的具体行为和属性
  - **特殊行为和属性**：具体描述这些植物类的特殊行为和属性。

**接口定义**

- **CreatePlant(type, position)**：string, Vector2 -> Plant
  - 创建指定类型的植物并放置在特定位置，返回植物实例。
  - **使用场景**：当玩家选择种植植物时调用。

- **UpgradePlant(plantId, level)**：int, int -> void
  - 升级指定ID的植物到指定等级。
  - **使用场景**：当玩家选择升级植物时调用。

- **TriggerSkill(plantId)**：int -> void
  - 触发指定植物的技能。
  - **使用场景**：当植物需要触发技能时调用。

**数据流**

1. 用户在用户界面层选择植物并指定位置。
2. 用户界面层调用PlantManager的CreatePlant方法，创建植物实例。
3. PlantManager将植物实例添加到植物列表中，并在指定位置显示。
4. 游戏运行过程中，UpdatePlants方法定期更新植物状态。
5. 当植物升级时，调用UpgradePlant方法，更新植物属性和状态。
6. 当植物需要触发技能时，调用TriggerSkill方法，执行技能效果。

- **数据流示意图**：
  - 插入数据流动示意图，展示从用户输入到植物状态更新的全过程。

**详细描述**

- **创建植物**：当玩家在游戏中选择种植植物时，系统调用PlantManager的CreatePlant方法。该方法创建指定类型的植物实例，并将其放置在指定的位置。创建的植物会被添加到植物列表中，供后续管理和更新。

- **升级植物**：植物可以通过消耗资源进行升级。玩家选择升级某个植物时，系统调用PlantManager的UpgradePlant方法。该方法根据提供的植物ID和升级等级参数，更新植物的属性和状态。升级后的植物将拥有更高的攻击力和生命值，并可能获得新的技能。

- **触发技能**：某些植物具有特殊技能，例如大范围攻击或生成额外资源。当需要触发植物技能时，系统调用PlantManager的TriggerSkill方法。该方法执行指定植物的技能效果，并更新游戏状态。

- **更新植物状态**：游戏运行过程中，系统定期调用PlantManager的UpdatePlants方法。该方法遍历植物列表，更新每个植物的状态，例如检查植物的生命值、攻击敌人、生成资源等。

- **植物状态管理**：植物可能处于不同的状态，例如正常、冰冻、燃烧等。状态变化可以由僵尸攻击、天气影响等触发。植物的ChangeState方法负责管理状态变化，确保植物在不同状态下表现出相应的行为。

- **关键场景描述**：描述植物在不同场景下的具体行为和处理逻辑，例如在受到攻击时如何处理、在生成资源时的具体流程等。

**模块间交互**

- **与僵尸管理模块**：植物攻击僵尸，僵尸对植物造成伤害。植物和僵尸之间通过事件系统进行交互。
- **与资源管理模块**：植物的生成和升级需要消耗资源。资源管理模块提供资源数据，植物管理模块进行资源消耗。
- **与用户界面模块**：用户通过UI选择和操作植物。UI层调用植物管理模块的接口，实现植物的创建、升级和技能触发。

- **模块间交互示意图**：
  - 插入模块间交互示意图，展示植物管理模块与其他模块的交互方式和数据传递过程。