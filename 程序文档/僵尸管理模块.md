### 僵尸管理模块详细设计文档

**功能概述**

僵尸管理模块负责管理僵尸的生成、行为控制、状态管理、攻击和防御等。它处理僵尸在游戏中的各种行为，包括移动、攻击植物、承受伤害等。

**类结构**

- **ZombieManager**：管理所有僵尸实例
  - **属性**：
    - **zombies**：List<Zombie> - 存储所有僵尸实例的列表
  - **方法**：
    - **SpawnZombie(type, path)**：Zombie - 在指定路径上生成指定类型的僵尸
      - **使用场景**：在关卡开始时或特定事件触发时调用，生成新的僵尸。
    - **RemoveZombie(zombieId)**：void - 删除指定ID的僵尸
      - **使用场景**：当僵尸被击败或移除时调用，清理僵尸实例。
    - **UpdateZombies()**：void - 更新所有僵尸的状态
      - **使用场景**：游戏运行过程中，定期调用此方法更新僵尸状态。
    - **TriggerSpecialBehavior(zombieId)**：void - 触发指定僵尸的特殊行为
      - **使用场景**：当僵尸需要执行特殊动作时调用，如跳跃、分裂等。

- **Zombie**：僵尸基类
  - **属性**：
    - **id**：int - 僵尸的唯一标识符
    - **type**：string - 僵尸类型
    - **health**：int - 僵尸的生命值
    - **damage**：int - 攻击力
    - **speed**：float - 移动速度
    - **state**：State - 僵尸的状态（如正常、冰冻、燃烧等）
    - **strategy**：Strategy - 攻击策略（如优先攻击植物或防御建筑）
  - **方法**：
    - **TakeDamage(amount)**：void - 使僵尸受到指定量的伤害
      - **使用场景**：当僵尸受到攻击时调用，减少僵尸的生命值。
    - **Move()**：void - 控制僵尸移动
      - **使用场景**：游戏运行过程中，僵尸自动沿路径移动。
    - **Attack()**：void - 僵尸进行攻击
      - **使用场景**：当僵尸接近植物时调用，执行攻击行为。
    - **ChangeState(state)**：void - 改变僵尸的状态
      - **使用场景**：当僵尸状态变化时调用，如被冰冻或燃烧。
    - **TriggerSpecialBehavior()**：void - 触发僵尸的特殊行为
      - **使用场景**：当需要执行特殊动作时调用，如跳跃、分裂等。

- 具体僵尸类（如**BasicZombie**, **BucketheadZombie**）：继承自Zombie类，实现每种僵尸的具体行为和属性
  - **特殊行为和属性**：具体描述这些僵尸类的特殊行为和属性。

**接口定义**

- **SpawnZombie(type, path)**：string, Path -> Zombie
  - 在指定路径上生成指定类型的僵尸，返回僵尸实例。
  - **使用场景**：在关卡开始时或特定事件触发时调用。

- **TriggerSpecialBehavior(zombieId)**：int -> void
  - 触发指定ID的僵尸的特殊行为。
  - **使用场景**：当僵尸需要执行特殊动作时调用。

**数据流**

1. 关卡开始时，系统调用ZombieManager的SpawnZombie方法，根据指定路径生成僵尸实例。
2. ZombieManager将僵尸实例添加到僵尸列表中，并在路径上显示。
3. 游戏运行过程中，UpdateZombies方法定期更新僵尸状态，包括移动和攻击行为。
4. 当僵尸受到攻击时，调用TakeDamage方法，减少僵尸生命值。
5. 当僵尸触发特殊行为时，调用TriggerSpecialBehavior方法，执行特定动作。

- **数据流示意图**：
  - 插入数据流动示意图，展示僵尸生成、移动、攻击和状态更新的全过程。

**详细描述**

- **生成僵尸**：当关卡开始或特定事件触发时，系统调用ZombieManager的SpawnZombie方法。该方法根据僵尸类型和路径生成僵尸实例，并将其添加到僵尸列表中。生成的僵尸会在路径上显示，并开始移动。

- **更新僵尸状态**：游戏运行过程中，系统定期调用ZombieManager的UpdateZombies方法。该方法遍历僵尸列表，更新每个僵尸的状态，包括移动、攻击和状态变化。僵尸会根据其速度沿路径移动，并在接近植物时执行攻击行为。

- **僵尸攻击**：当僵尸接近植物时，调用Zombie的Attack方法，执行攻击行为。攻击会对植物造成伤害，减少植物的生命值。

- **承受伤害**：当僵尸受到攻击时，调用Zombie的TakeDamage方法，减少僵尸的生命值。如果生命值降为零，调用ZombieManager的RemoveZombie方法，将僵尸从列表中移除。

- **状态管理**：僵尸可能处于不同的状态，如正常、冰冻、燃烧等。状态变化可以由植物攻击或其他事件触发。僵尸的ChangeState方法负责管理状态变化，确保僵尸在不同状态下表现出相应的行为。

- **特殊行为**：某些僵尸具有特殊行为，如跳跃、分裂、隐形等。当需要执行特殊行为时，系统调用ZombieManager的TriggerSpecialBehavior方法。该方法根据僵尸类型和状态执行特定的动作，增强游戏的多样性和挑战性。

- **关键场景描述**：描述僵尸在不同场景下的具体行为和处理逻辑，例如在受到攻击时如何处理、在执行特殊行为时的具体流程等。

**模块间交互**

- **与植物管理模块**：僵尸攻击植物，植物对僵尸造成伤害。僵尸和植物之间通过事件系统进行交互。
- **与关卡管理模块**：关卡管理模块负责生成僵尸波次，并通过ZombieManager生成僵尸。ZombieManager更新僵尸状态，并反馈关卡进度。
- **与用户界面模块**：用户界面显示僵尸状态和进度。用户界面层调用僵尸管理模块的接口，获取僵尸信息并进行显示。

- **模块间交互示意图**：
  - 插入模块间交互示意图，展示僵尸管理模块与其他模块的交互方式和数据传递过程。

通过上述详细设计，我们确保僵尸管理模块的功能清晰、实现逻辑明确，并与其他模块协同工作。这个设计为开发团队提供了明确的指导，提高了文档的可操作性和实用性。